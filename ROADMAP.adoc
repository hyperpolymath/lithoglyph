= FormDB Roadmap
:toc:
:icons: font

[.lead]
Development phases from concept to production.

== Milestone Summary

[cols="1,2,1,1"]
|===
| Milestone | Description | Version | Status

| M1 | Core Specifications | v0.0.2 | âœ… Complete
| M2-M5 | Forth PoC Implementation | v0.0.2 | âœ… Complete
| M6 | Machine-Readable Artefacts | v0.0.2 | âœ… Complete
| M7 | Complete Documentation Suite | v0.0.3 | âœ… Complete
| M8 | Form.Runtime (FQL Engine) | v0.0.4 | âœ… Complete
| M9 | Form.Normalizer | v0.0.4 | âœ… Complete
| M10 | Production Hardening | v0.0.4 | âœ… Complete
| M11 | HTTP API Server | - | ðŸš§ Next
| M12 | Language Bindings (ReScript, PHP) | - | ðŸ“‹ Planned
| M13 | CMS Integration (WordPress) | - | ðŸ“‹ Planned
|===

== Phase 0: Specification âœ…

*Status*: Complete (v0.0.2)

*Goal*: Complete specifications for all core components.

=== Deliverables

* [x] `formdb.scm` - Unified specification
* [x] Repository structure
* [x] `spec/blocks.adoc` - Block format spec (4 KiB blocks, 64-byte headers)
* [x] `spec/journal.adoc` - Journal format spec (append-only, sequence numbers)
* [x] `spec/fql.adoc` - FQL grammar (EBNF, provenance syntax)
* [x] `spec/fql-dependent-types.md` - FQLdt with Lean 4 integration
* [x] `spec/self-normalizing.adoc` - Self-normalizing database spec
* [x] `spec/cloud-storage.adoc` - Object storage integration
* [x] `spec/fql-philosophy.adoc` - Design philosophy

== Phase 1: Form.Blocks PoC âœ…

*Status*: Complete (v0.0.2)

*Goal*: Working storage layer with journal and reversibility.

=== Deliverables

* [x] Fixed-size block implementation (`core-forth/src/formdb-blocks.fs`)
* [x] Block header structure with magic, version, type, checksums
* [x] Memory buffer management
* [x] CRC32C implementation (Castagnoli polynomial)

== Phase 2: Form.Journal PoC âœ…

*Status*: Complete (v0.0.2)

*Goal*: Append-only journal with crash recovery.

=== Deliverables

* [x] Append-only journal (`core-forth/src/formdb-journal.fs`)
* [x] Sequence numbering
* [x] Operation logging with inverses
* [x] Crash recovery primitives

== Phase 3: Form.Model PoC âœ…

*Status*: Complete (v0.0.2)

*Goal*: Multi-model layer on top of blocks.

=== Deliverables

* [x] Document collection support (`core-forth/src/formdb-model.fs`)
* [x] Edge collection support
* [x] Schema metadata storage
* [x] Constraint storage

== Phase 4: Form.Bridge âœ…

*Status*: Complete (v0.0.2)

*Goal*: Stable ABI for runtime integration.

=== Deliverables

* [x] Zig-only ABI (C dependency eliminated)
* [x] FFI design for Factor integration

=== Note

Architecture changed from C ABI to Zig-only ABI for better safety and integration.

== Phase 5: Documentation âœ…

*Status*: Complete (v0.0.3)

*Goal*: Comprehensive documentation for production use.

=== Deliverables

* [x] `QUICKSTART.adoc` - 15-minute tutorial
* [x] `VERSIONING.adoc` - Stability policy
* [x] `docs/DEPLOYMENT.adoc` - Docker, Kubernetes, systemd
* [x] `docs/SECURITY-AUTH.adoc` - Authentication, authorization, hardening
* [x] `docs/API-REFERENCE.adoc` - Form.Bridge FFI, FQL API
* [x] `docs/MIGRATION-FROM-RDBMS.adoc` - PostgreSQL/MySQL/SQLite migration
* [x] `docs/OBSERVABILITY.adoc` - Logging, metrics, tracing, dashboards
* [x] `docs/INTEGRATION-PATTERNS.adoc` - Message queues, search, analytics, AI/ML

== Phase 6: Form.Runtime PoC âœ…

*Status*: Complete (v0.0.4)

*Goal*: FQL parser/planner/executor.

=== Deliverables

* [x] FDQL parser (`core-factor/fdql/fdql.factor`) - Full PEG-based parser
* [x] Query planner - Cost-based planning with step types
* [x] Executor - In-memory and pluggable persistent storage
* [x] EXPLAIN functionality - EXPLAIN, ANALYZE, VERBOSE modes
* [x] Provenance output - WITH PROVENANCE clause support

=== Acceptance Criteria

* âœ… FQL PoC subset fully functional
* âœ… EXPLAIN returns readable plans (including VERBOSE mode)
* âœ… Provenance tracks to journal entries
* âœ… Constraint rejections explained

== Phase 7: Form.Normalizer (Self-Normalizing) âœ…

*Status*: Complete (v0.0.4)

*Goal*: Automatic functional dependency discovery, type-encoded normal forms, and proof-carrying schema evolution.

=== Deliverables

* [x] FD discovery algorithm (`normalizer/factor/fd-discovery.factor`) - DFD algorithm
* [x] `INTROSPECT SCHEMA` FQL command - Schema inspection
* [x] Type encoding in Lean 4 (`normalizer/lean/FunDep.lean`)
* [x] Normal form predicates (1NF through BCNF)
* [x] Proposal generation (`denormalization-proposal`)
* [x] Three-phase migration (`normalizer/factor/migration.factor`)
* [x] Query rewriting during migration transitions

=== Acceptance Criteria

* âœ… Discover FDs with configurable confidence threshold (three-tier: high/medium/low)
* âœ… FunDep.lean types compatible with FQL-dt
* âœ… Normal form analysis (1NF-BCNF) with violation detection
* âœ… Generate human/agent-readable proposals
* âœ… Three-phase migration (Announce â†’ Shadow â†’ Commit) with rollback
* âœ… Lean4 proofs for verified transformations

=== Resolved Questions

* âœ… Q-NORM-001: DFD algorithm chosen (depth-first with partition refinement)
* âœ… Q-NORM-002: Three-tier confidence classification
* âœ… Q-NORM-003: Denormalization proposals with join-based approach
* âœ… Q-NORM-004: CBOR-encoded proof blobs for FFI
* âœ… Q-NORM-005: Query rewriting via migration framework

See link:spec/self-normalizing.adoc[Self-Normalizing Specification] for full details.

== Phase 8: Production Hardening âœ…

*Status*: Complete (v0.0.4)

*Goal*: Complete PoC with all seam checks passing, production-ready.

=== Deliverables

* [x] Seam tests (`core-factor/fdql/seam-tests.factor`) - Full pipeline validation
* [x] End-to-end test suite - Parser â†’ Planner â†’ Executor â†’ Normalizer
* [x] Performance benchmarks (`core-factor/fdql/benchmarks.factor`)
* [x] Migration tests (`normalizer/factor/migration-tests.factor`)
* [x] Pluggable storage backend (`core-factor/fdql/storage-backend.factor`)

=== Acceptance Criteria

* âœ… All seam tests pass (full pipeline)
* âœ… Benchmark suite for regression detection
* âœ… Memory/bridge backend abstraction
* âœ… EXPLAIN correlation tests
* âœ… Large dataset stress tests

== Phase 9: HTTP API Server

*Status*: ðŸ“‹ Planned

*Goal*: RESTful HTTP server exposing FormDB operations for language-agnostic access.

*Dependencies*: Phase 6 (Form.Runtime) must be complete.

=== Deliverables

* [ ] HTTP server binary (`formdb-server`)
* [ ] REST API endpoints for all FQL operations
* [ ] JSON request/response format
* [ ] Authentication middleware (JWT, API keys)
* [ ] OpenAPI/Swagger specification
* [ ] Health check and metrics endpoints

=== API Design

[source]
----
POST /v1/query          # Execute FQL query
POST /v1/collections    # Create collection
GET  /v1/collections    # List collections
GET  /v1/journal        # Query journal entries
GET  /v1/health         # Health check
GET  /v1/metrics        # Prometheus metrics
----

=== Acceptance Criteria

* All FQL operations accessible via HTTP
* Provenance passed via headers or request body
* JSON responses include journal sequence numbers
* OpenAPI spec generates valid clients

== Phase 10: Language Bindings

*Status*: ðŸ“‹ Planned

*Goal*: Native client libraries for ReScript and PHP.

*Dependencies*: Phase 9 (HTTP API) should be complete for HTTP clients.

=== ReScript Client (`@formdb/rescript`)

* [ ] HTTP client using Fetch API
* [ ] Type-safe FQL query builder
* [ ] Provenance helpers
* [ ] Response type definitions
* [ ] Deno-compatible (no Node.js)

[source,rescript]
----
// Example usage
let result = await FormDB.query(
  ~collection="articles",
  ~where=Field("status", Eq, "published"),
  ~provenance={actor: "editor@news.org", rationale: "Daily review"},
)
----

=== PHP Client (`formdb/formdb-php`)

* [ ] PSR-18 HTTP client compatibility
* [ ] Composer package
* [ ] FQL query builder (fluent interface)
* [ ] Provenance handling
* [ ] Laravel/Symfony integration helpers

[source,php]
----
<?php
// Example usage
$result = $formdb->query()
    ->collection('articles')
    ->where('status', '=', 'published')
    ->withProvenance('editor@news.org', 'Daily review')
    ->execute();
----

=== Acceptance Criteria

* Both clients pass integration tests against formdb-server
* ReScript client works with Deno
* PHP client installable via Composer
* Documentation with examples

== Phase 11: CMS Integration (WordPress)

*Status*: ðŸ“‹ Planned

*Goal*: WordPress plugin for FormDB-backed content with full provenance.

*Dependencies*: Phase 10 (PHP client) must be complete.

=== Deliverables

* [ ] WordPress plugin (`formdb-wordpress`)
* [ ] Custom post type backed by FormDB
* [ ] Edit history with provenance (who changed what, why)
* [ ] Time-travel: view any historical version
* [ ] Revision comparison with narrative diffs
* [ ] Admin UI for FormDB connection settings
* [ ] WP-CLI commands for FormDB operations

=== Features

* **Provenance on Save**: Every post edit records actor + rationale
* **Audit Log**: Complete history visible in admin
* **Rollback**: Restore any previous version with one click
* **Evidence Chain**: For journalism, link sources to claims
* **Multi-site**: Shared FormDB across WordPress network

=== Acceptance Criteria

* Plugin installable from WordPress admin
* Posts stored in FormDB with full provenance
* Revision history shows narrative explanations
* Rollback works without data loss
* Compatible with WordPress 6.x+

== Future Phases (Post-PoC)

=== Form.ControlPlane

* Gleam/OTP session management
* Cluster coordination
* Production supervision

=== Distribution

* Multi-node replication
* Consensus protocol selection
* Network protocol design

=== Ecosystem

* Additional language bindings (Rust, Python via HTTP)
* IDE integration (VS Code, JetBrains)
* Visualization tools
* FormDB Studio (zero-friction GUI)
* FormDB Debugger (proof-carrying debugger)
* Other CMS integrations (Drupal, Ghost, Strapi)

== Non-Goals (Explicitly Deferred)

* SQL compatibility layer
* OLAP optimizations
* Full-text search (use integration patterns instead)
* Time-series optimizations
* Real-time subscriptions (use CDC/webhooks instead)

These may be addressed post-PoC based on community needs.

== Version History

[cols="1,1,2"]
|===
| Version | Date | Milestone

| v0.0.4 | 2026-01-12 | M8-M10 - MVP Complete (Form.Runtime + Form.Normalizer)
| v0.0.3 | 2026-01-12 | M7 - Complete Documentation Suite
| v0.0.2 | 2026-01-11 | M1-M6 - Core Specs + Forth PoC
| v0.0.1 | 2026-01-03 | Repository Initialization
|===

See link:CHANGELOG.md[CHANGELOG] for detailed release notes.
